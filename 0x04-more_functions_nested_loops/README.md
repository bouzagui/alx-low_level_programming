More function , more nested loops
